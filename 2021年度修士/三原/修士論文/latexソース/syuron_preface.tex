\chapter{はじめに}
ストリームデータとは時間経過と共に継続的に次々と生成されるデータのことを言う．近年，IoTやSNSの発展に
伴いストリームデータが取り扱われる機会が増加している．例えば，IoTにおけるセンサからの観測データはストリーム
データである．また，特定ユーザのtwitterにおけるツイートやウェブぺージの閲覧履歴も時間と共に新データが
追加されるという点でストリームデータである．こうしてストリームデータの増加に連れて，ストリームデータを
対象とした類似検索も重要になっている．例えば，過去の異常パターンとの類似性に基づいた異常検知 \cite{microbiome} や，SNSの
コンテンツが似たユーザを見つけて類似ユーザの挙動からアイテムを推薦するユーザベースの情報推薦 \cite{POI} などは
ストリームデータを対象とした類似検索に帰着して解ける．後者の例では，ユーザ$u$のSNSへの投稿内容を時間経過に
伴ってデータが増えるストリームデータと見なし，ストリームデータを対象とした類似検索によって$u$と嗜好性が似た
類似ユーザを見つける．
最近のストリームデータを対象とした類似検索では，ストリームデータを生成されたデータの集合として表現し
集合間類似検索によって類似ストリームデータを探すアプローチが主流である．通常の集合間類似検索と比べると，
新たなデータの生成により集合の要素が動的に変化するため類似検索結果を更新する必要がある点が異なる．
２つの集合$A,B$に対する類似度$\mbox{sim}(A,B)$としてはJaccard係数がよく用いられるが，$A$や$B$が変化する度に
Jaccard係数を計算するオーバーヘッドは大きい．そこでMin-Hash \cite{Minhash}を用いて$A$と$B$のコンパクトなスケッチ
$ms_A,ms_B$を生成し，スケッチ間でJaccard係数を近似計算する手法がいろいろ提案されている．これらの手法はいずれ
も集合の変化に対するスケッチ更新を効率化するが，
\begin{itemize}
\item データ削除を取り扱えるか
\item 同種類の要素を複数持つ多重集合に対して拡張Jaccard係数の近似値を計算できるか
\end{itemize}
という2点で機能的に異なる．データ削除に関してはストリームデータ内では新しいデータほど最新の状況を反映して価値が高い
ところから, 古いデータを軽視するモデルが2種類存在する．
\begin{enumerate}
\item スライディングウィンドウモデル：データストリームの直近$w$個要素をスライディングウィンドウと定義し，
時刻が進むとウィンドウに到着データを追加し，ウィンドウ内の最古データを廃棄する．
\item 減衰モデル：データストリームを要素に重みが付与された重み付き集合として扱い，時間経過に伴って
古いデータの重みを減衰する．
\end{enumerate}
MaxLogHash \cite{Maxloghash}はMin-Hashを省メモリ化する$b$-bit Minhash\cite{b-bit}をデータ追加時に更新可能にした
がデータ削除を取り扱えない．Datarら\cite{Datar}はスライディングウィンドウモデルでデータ削除に対しても
ハッシュ値を更新できるアルゴリズムを考案した．さらにスケッチ更新のために保持しないといけないスライディング
ウィンドウ内の要素数が$O(\log W)$となることを証明した．$W$はスライディングウィンドウのサイズである．
しかし，Datarらの手法は多重集合を取り扱えない．Buryらは\cite{Bury}はデータ削除が任意の順序で発生しても
ハッシュ値を更新できる手法を構築したが，やはり多重集合は取り扱えない．Histosketch\cite{HistoSketch}は多重集合に関して
データ削除を取り扱える唯一の手法であるが，減衰モデルを想定している．したがって，スライディングウィンドウ
モデルで多重集合を取り扱える手法は存在しない．
そこで本研究では，スライディングウィンドウに対して多重集合を取り扱える手法を実現することを目的とし，
Datarらの手法を多重集合を取り扱えるように拡張する．多重集合の場合，スライディングウィンドウ内の同種類の要素数
に依って，同一要素に割り当てられるハッシュ値が変化するという難題があるが，本研究ではDatarらの手法をハッシュ値
の変化に対処できるように修正した．
%動的に変化する集合に対する効率的なMin-Hashスケッチの生成方法を
%研究対象とする．Xuらの近似解法ではクエリ集合が$Q_t$から$Q_{t+1}$に変化する度に，Min-Hashスケッチ$ms_{Q_{t+1}}$を完全
%に再計算する．しかし，$Q_t$と$Q_{t+1}$は多数の要素を共有するにもかかわらず，Min-Hashスケッチを完全に再計算するのは
%非効率である．$ms_{Q_{t+1}}$をMin-Hashスケッチ$ms_{Q_{t})}$を再利用して計算する手法が望まれるが，そのためには
%$Q_{t+1}$に対するMin-Hashのハッシュ値$h(Q_{t+1})$を，$Q_{t}$に対するハッシュ値$h(Q_{t})$を更新して計算出来なければ
%ならない．幸いそのような技術は既存であり，Datar[1]らがスライディングモデルに動的で変化する集合を対象
%としたハッシュ値更アルゴリズムを
%そこで本研究では，時間と共に変化する多重集合に対してMin-Hashのハッシュ値を更新できるように
%実験により，提案手法を用いて多重集合に対するMin-Hashスケッチを高速に計算できることを，集合間類似検索が高速に
%完了することから示した．集合間類似検索問題としては，データベースに$n$個のデータストリームのスライディングウィンドウにより
%定まる$n$個の動的に変化する集合$\{S^t_1,S^t_2,\cdots, S^t_n\}$が登録され，クエリ集合$Q$が静的な
%Continuous Similarity Search for Evolving　Database問題[2]を取り扱った．
以下，本論文の構成を述べる．2章で提案手法の要素技術となる多重集合，集合間類似度，Min-Hashの概念を
説明する．3章では従来手法となるDatarらの動的に変化する集合を対象としたハッシュ値更アルゴリズムを紹介する．
4章で提案手法となる時間と共に変化する多重集合に対してMin-Hashのハッシュ値を更新アルゴリズムを提案する．
5章で4章のアルゴリズムを複数個の要素が出入りするウインドウに対応するように拡張したアルゴリズムを提案する．
6章で提案手法を人工データ，実データを用いて評価する．提案手法がハッシュ値を完全に再計算するベースライン手法
よりもMin-Hashスケッチを高速に更新できることを示す．%次にスケッチ更新のために保持しないといけないスライディングウィンドウ内の要素数が理論的に証明はできていないものの，実験的に$\log W$に比例することを示す．
7章でまとめと今後の課題を述べる．
%また，これらはユーザの嗜好性を表して
%いるため情報推薦に活用される．ここで，1データストリームを到着したデータの集りと捉えると，1データストリーム
%はユーザ嗜好性を表す動的に要素が追加される集合ということになる．従って，情報推薦は，動的に要素が追加%
%される集合に対する集合を対象とした
%さらに，
%このような背景の下、Xu[2]らは動的に変化する集合をクエリとして，静的な集合のデータベース$D$から
%毎時刻上位$K$個の類似集合を検索するContinuous Similarity Search for Evolving　Queries問題を提唱とした．
%この問題設定では，クエリ集合$Q_t$をスライディングウィンドウで定義し，クエリ集合の変化に対応して検索結果を
%更新する必要がある．ここで$t$は時刻であり，クエリ集合が$t$によって変わることを表す．
%この問題は，$Q_t$とデータベース$D$の全集合間で，類似度(Jaccard係数)を毎時刻計算
%し，上位$k$個の集合を返すことで自明に厳密に解ける．しかし，この厳密解法では２つの集合$A$と$B$間で
%類似度$\mbox sim(A, B)$を計算するオーバーヘッドが大きい．そこで，Xuらは，Min-Hash[6]を用いて$A$と$B$のコンパクトなスケッチ
%(Min-Hashスケッチ)$ms_A,ms_B$[4]を生成し，スケッチ間でJaccard係数を近似計算する近似解法も提案している．
